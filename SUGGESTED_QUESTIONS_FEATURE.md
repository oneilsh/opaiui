# Suggested Questions Feature

This document describes the new suggested questions feature implemented in opaiui.

## Overview

The suggested questions feature adds OpenAI-style clickable question buttons near the chat input. These buttons can be:
- **Static**: Defined at initialization time
- **Dynamic**: Generated by the agent during conversation based on context

## Configuration

### Basic Setup (Static Questions)

```python
from opaiui.app import AgentConfig, AppConfig, serve

agent_configs = {
    "My Agent": AgentConfig(
        agent=my_agent,
        suggested_questions=[
            "What can you do?",
            "Tell me about feature X",
            "How do I get started?"
        ],
        enable_suggested_questions=True,  # Enable the feature
    )
}
```

### Dynamic Questions

To allow agents to suggest questions based on conversation context:

```python
agent_configs = {
    "My Agent": AgentConfig(
        agent=my_agent,
        suggested_questions=[
            "What can you do?",
            "Tell me about feature X"
        ],
        enable_suggested_questions=True,
        enable_dynamic_suggested_questions=True,  # Enable dynamic suggestions
    )
}
```

When `enable_dynamic_suggested_questions=True`, a new tool is automatically registered with the agent:

**Tool Name**: `suggest_question_for_user`
**Description**: Add a suggested question button for the user to click. The question should be relevant to the current conversation context and help guide the user's next interaction.
**Parameters**: 
- `question` (str): The question to suggest

The agent can call this tool during conversation to add new suggested questions.

### Manual Question Addition

You can also manually add suggested questions from within tools:

```python
from opaiui.app import add_suggested_question

@my_agent.tool
async def my_custom_tool(ctx: RunContext):
    # Your tool logic here
    add_suggested_question("Ask me about the results")
    return "Tool completed"
```

## Behavior

- Questions are displayed as clickable pill buttons below the chat messages
- Pills wrap naturally to fit the available width
- Once a question is clicked:
  - The pills disappear immediately (smooth UX - no jarring re-renders)
  - The question is submitted as a regular user message
  - That question won't appear in the list again
- The "Clear Chat" button resets the suggested questions to their initial state
- Suggested questions are preserved when sharing sessions
- A "Show suggested questions" toggle appears in Settings if the feature is enabled:
  - Defaults to showing questions (checked)
  - When unchecked, hides all suggested questions from view
  - Setting is preserved when sharing sessions

## UI Layout

The suggested questions are displayed using Streamlit's `st.pills` widget:
- Appear below all chat messages and above the chat input box
- Pills wrap naturally to fit the available width (no fixed columns)
- Disabled during agent processing (matches chat input behavior)
- Clean, modern pill-button appearance similar to OpenAI's interface
- When clicked, the question is submitted and removed from the list

## Example Use Cases

1. **Onboarding**: Provide initial questions to guide new users
   ```python
   suggested_questions=[
       "Show me an example",
       "What are your capabilities?",
       "How do I use feature X?"
   ]
   ```

2. **Context-aware suggestions**: Let the agent suggest next steps
   ```python
   # Agent can call suggest_question_for_user() after completing a task
   # to guide the user on what to do next
   enable_dynamic_suggested_questions=True
   ```

3. **Workflow guidance**: Guide users through multi-step processes
   ```python
   # Agent suggests "Step 2: Configure settings" after completing Step 1
   enable_dynamic_suggested_questions=True
   ```

## Demo

See `localtests/demo.py` for a working example that showcases both static and dynamic suggested questions.

Run the demo with:
```bash
cd localtests
streamlit run demo.py
```

